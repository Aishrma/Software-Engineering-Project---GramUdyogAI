@startuml
title Sequence Diagram: Get AI Business Suggestion with Authentication

actor User
participant "React Frontend" as FE
participant "Auth Middleware" as Auth
participant "API Router\n(routes_business.py)" as Router
participant "Core Logic\n(business_suggestion_generation.py)" as Core
participant "Enhanced LLM Service\n(enhanced_llm.py)" as LLM
participant "External AI Service\n(OpenAI/Groq)" as AIService
participant "Database" as DB
participant "Notification Service" as Notify

autonumber

User -> FE: Navigates to Business Suggestion page
FE -> Auth: Verify JWT Token
Auth --> FE: Token Valid

User -> FE: Fills and submits suggestion form\n(skills, resources, location)
FE -> Router: POST /api/business/suggest\nAuthorization: Bearer <token>

Router -> Auth: Validate user session
Auth -> DB: Verify user credentials
DB --> Auth: User authenticated
Auth --> Router: Authorization granted

Router -> Core: generate_suggestions(user_data)
Core -> DB: Fetch user profile details
DB --> Core: Return profile (skills, resources, location)

Core -> LLM: prepare_business_prompt(profile)
LLM --> Core: Formatted prompt

Core -> AIService: Request business suggestions\n(prompt, model parameters)
AIService -> AIService: Process with AI model
AIService --> Core: Return generated business suggestions

Core -> DB: Save suggestions with userId
DB --> Core: Confirmation

Core -> Notify: Create notification for user
Notify -> DB: Store notification
Notify --> Core: Notification sent

Core --> Router: Return list of suggestions
Router --> FE: 200 OK (JSON with suggestions)
FE -> FE: Parse and format data
FE -> User: Renders and displays suggestions

alt User wants to translate
    User -> FE: Click translate button
    FE -> Router: POST /api/translate
    Router -> Core: translate_text(text, target_lang)
    Core -> AIService: Translation request
    AIService --> Core: Translated text
    Core --> Router: Return translation
    Router --> FE: 200 OK (translated text)
    FE -> User: Display translated content
end

@enduml
